"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4809],{23010:function(a,b,c){var d=c(26042),e=c(69396),f=c(99534),g=c(85893),h=c(67294),i=c(59830),j=c(33951),k=function(a,b){var c=a.className,h=a.onChange,k=a.source,l=(0,f.Z)(a,["className","onChange","source"]);return i.OL?(0,g.jsx)("div",{className:c,children:(0,g.jsx)(j.Z,(0,e.Z)((0,d.Z)({},l),{sitekey:"hub"===k?i.ao:i.OL,onVerify:h,ref:b,theme:"dark",children:" "}))}):null},l=h.forwardRef(k);b.Z=h.memo(l)},74809:function(a,b,c){c.d(b,{Z:function(){return B}});var d,e,f=c(26042),g=c(69396),h=c(29815),i=c(85893),j=c(67294),k=c(11163),l=c(87536),m=c(86501),n=c(99245),o=c.n(n),p=c(29208),q=c.n(p),r=c(9005),s=c(3360),t=c(21405),u=c(22243);(e=d||(d={})).DRAFT="draft",e.PUBLISHED="published",e.PENDING="pending",e.DECLINED="declined";var v=c(75960),w=c(110),x=function(a){var b=a.data,c=a.title,d=a.onChange,e=a.currentResource,f=(0,j.useState)(!1),g=f[0],k=f[1],l=(0,j.useState)(""),m=l[0],n=l[1],o=function(){d((0,h.Z)(b).concat([""]))},p=function(a){return function(){k(a)}},q=function(a){var b=(0,r.kr)(a).listText.join(", ");return b?"Please remove profane word: ".concat(b):""};return(0,j.useEffect)(function(){"pros"===c?n("What you like about "+("guild"===e?"guild":"game")):n("What the "+("guild"===e?"guild":"game")+" should be improve")},[c,e]),(0,i.jsxs)("div",{className:"mb-9",children:[(0,i.jsxs)("div",{className:"font-bold text-base uppercase mb-6",children:["add ",c]}),null==b?void 0:b.map(function(a,e){var f,j;return(0,i.jsxs)("div",{className:"flex items-center font-mechanic pb-3",onMouseEnter:p(!0),onMouseLeave:p(!1),children:[(0,i.jsxs)("div",{className:"font-semibold text-white/50 text-sm w-5",children:[+e+1,"."]}),(0,i.jsxs)("div",{className:"flex-1 relative",children:[(0,i.jsx)("input",{value:a,maxLength:100,autoComplete:"off",minLength:5,className:" bg-[#303035] border border-[#3C3C42] placeholder-white placeholder-size-[26px] placeholder-opacity-30 font-casual text-sm rounded-sm px-4 py-2 w-full focus-visible:border-gamefiDark-350 invalid:border-gamefiRed",name:"".concat(c,"-").concat(e),placeholder:m,onChange:(f=e,function(a){var c=(0,h.Z)(b);c[f]=a.target.value,d(c)})}),(null==a?void 0:a.trim())&&a.trim().length<5?(0,i.jsx)("div",{className:"mt-2 text-normal text-red-500 ",children:"At least 5 characters"}):(0,i.jsx)("div",{className:"mt-2 text-normal text-red-500 ",children:q(a)}),g&&(0,i.jsx)("button",{className:"absolute right-[-11px] top-2 rounded-full p-1 bg-[#15171E] cursor-pointer",onClick:(j=e,function(){var a=(0,h.Z)(b);0===j&&1===b.length?a[j]="":a.splice(j,1),d(a)}),children:(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM11.5 10.1L10.1 11.5L8 9.4L5.9 11.5L4.5 10.1L6.6 8L4.5 5.9L5.9 4.5L8 6.6L10.1 4.5L11.5 5.9L9.4 8L11.5 10.1Z",fill:"#53535B",className:"hover:fill-[#36C40C]"})})})]})]},"".concat(c,"-").concat(e))}),(0,i.jsx)("div",{className:"flex justify-end",children:(null==b?void 0:b.length)<=9&&(0,i.jsxs)("button",{className:"font-mechanic bg-gamefiDark-900 text-gamefiGreen-700 hover:text-gamefiGreen-200 py-2 pl-7 leading-5 font-bold text-sm",onClick:o,children:["Add more ",c]})})]})},y=function(a){return a.reduce(function(a,b){var c=null==b?void 0:b.trim();return c&&a.push({text:c}),a},[])},z=function(a){var b=[];switch(a){case"aggregator":b.push("Rate this project is required");break;case"guild":b.push("Rate this guild is required")}return b.push("At least 10 and max 100 characters are required in Title","At least 50 characters are required in Review"),b},A=function(a){return"Please remove profane word".concat(a?": ".concat(a):"")},B=function(a){var b,c,e,n,p,B=a.data,C=a.currentResource,D=(0,j.useState)([""]),E=D[0],F=D[1],G=(0,j.useState)([""]),H=G[0],I=G[1],J=(0,j.useState)(null),K=J[0],L=J[1],M=(0,j.useState)(""),N=M[0],O=M[1],P=(0,l.cI)(),Q=P.register,R=P.formState,S=R.errors,T=R.isSubmitted,U=P.setError,V=P.clearErrors,W=P.handleSubmit,X=P.setValue,Y=P.watch,Z=(0,j.useState)(!1),$=Z[0],_=Z[1],aa=(0,j.useState)(!1),ab=aa[0],ac=aa[1],ad=(0,k.useRouter)(),ae=ad.query.slug,af=z(C),ag=B.id,ah=B.name,ai=(0,u.Z)().accountHub,aj=(0,t.Z)().connectWallet;(0,j.useEffect)(function(){o()(E)?V("pros"):(0,r.kr)(E.join(" ")).isProfane?U("pros",{type:"pros",message:"pros"}):V("pros")},[E]),(0,j.useEffect)(function(){o()(H)?V("cons"):(0,r.kr)(H.join(" ")).isProfane?U("cons",{type:"cons",message:"cons"}):V("cons")},[H]),(0,j.useEffect)(function(){var a;if(o()(ai)){ac(!1),al();return}switch(_(!0),C){case"aggregator":a="GET_REVIEW_AND_RATE_BY_USER_ID_FOR_AGGREGATOR";break;case"guild":a="GET_REVIEW_AND_RATE_BY_USER_ID_FOR_GUILD"}(0,r._i)("/api/hub/reviews",{method:"POST",body:JSON.stringify({variables:{walletAddress:ai.walletAddress,slug:ae},query:a})}).then(function(a){if(_(!1),!o()(a)){var b=(0,s.F)(a.data),c=q()(b,"reviews[0]",{});o()(c)||(L(c),o()(c.pros)||F(c.pros.map(function(a){return a.text})),o()(c.cons)||I(c.cons.map(function(a){return a.text})),X("title",c.title),X("review",c.review),ac(c.status===d.PENDING));var e=q()(b,"rates[0].rate","");e&&O(e)}}).catch(function(){return _(!1)})},[ai,ae]);var ak=function(a){var b=(0,r.kr)(a);return!b.isProfane||b.listText.join(", ")},al=function(){X("title",""),X("review",""),L(null),O(""),F([""]),I([""])},am=function(a){return function(b){if(b.title.trim().length<10||b.title.trim().length>100){U("title",{message:"error"});return}if(b.review.trim().length<50){U("review",{message:"error"});return}return(0,h.Z)(E).concat((0,h.Z)(H)).some(function(a){return(null==a?void 0:a.trim())&&a.trim().length<5})?m.ZP.error("Please check for errors!"):N?void(_(!0),aj().then(function(c){if(c.error){_(!1),console.debug(c.error),m.ZP.error("Something went wrong. Please try again.");return}var e=c.walletAddress,h=c.signature,i=K?"/api/hub/reviews/".concat(K.id):"/api/hub/reviews/createReview",j=(0,g.Z)((0,f.Z)({},b),{status:a,pros:y(E),cons:y(H)});j[C]=ag;var k={rate:N};k[C]=ag;var l=(0,r._i)(i,{method:K?"PUT":"POST",body:JSON.stringify(j),headers:{"X-Signature":h,"X-Wallet-Address":e}}),n=(0,r._i)("/api/hub/reviews/createRate",{method:"POST",body:JSON.stringify(k),headers:{"X-Signature":h,"X-Wallet-Address":e}});Promise.all([l,n]).then(function(b){_(!1),!b||b.some(function(a){return a.error})?m.ZP.error("Something went wrong. Please try again."):(m.ZP.success(a===d.DRAFT?"Your draft is saved.":"Your submission has been sent"),ad.push("/account/review?status=".concat(a)))}).catch(function(a){_(!1),m.ZP.error("Something went wrong. Please try again."),console.debug("err",a)})}).catch(function(a){_(!1),console.debug(a)})):m.ZP.error("Please rate this "+("guild"===C?"guild !":"game !"))}},an=function(){W(am(d.DRAFT))()},ao=function(){W(am(d.PENDING))()},ap=function(){switch(C){case"aggregator":ad.push("/hub/".concat(ae,"?tab=2")).finally(function(){});break;case"guild":ad.back()}},aq=function(a){return function(){O(a)}};return(0,i.jsxs)("div",{className:"md:grid grid-rows md:grid-cols-8 md:gap-4 xl:gap-7 mb-4",children:[$&&(0,i.jsx)(v.Z,{}),(0,i.jsxs)("div",{className:"col-span-12 md:col-span-5 mb-4",children:[(0,i.jsxs)("div",{className:"uppercase font-bold text-2xl mb-9",children:["You are reviewing ",(0,i.jsx)("span",{className:"text-gamefiGreen-700",children:ah})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsxs)("div",{style:{background:"linear-gradient(90.55deg, #303035 0.3%, rgba(48, 48, 53, 0) 90.04%)"},className:"p-7 radius-1 flex justify-between items-center text-[13px] flex-col sm:flex-row",children:[(0,i.jsxs)("div",{className:"font-bold text-center sm:text-left flex-1 mb-3 sm:mb-0",children:["RATE THIS ","guild"===C?"GUILD":"PROJECT"]}),(0,i.jsxs)("div",{className:"flex justify-end items-center flex-wrap",children:[(0,i.jsx)("div",{className:"pr-6 font-casual text-white/30 hidden sm:block",children:"Click to rate"}),(0,i.jsx)(w.Z,{rate:N,callBack:aq,disabled:$})]})]}),T&&!N&&(0,i.jsx)("div",{className:"mt-2 text-normal text-red-500 ",children:af[0]})]}),(0,i.jsxs)("form",{className:"w-full m-auto pb-4",children:[(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("div",{className:"text-sm mb-2 font-casual text-gamefiDark-350 text-[13px]",children:"Title *"}),(0,i.jsx)("input",(0,f.Z)({className:"bg-[#303035] border border-[#3C3C42] placeholder-white placeholder-opacity-30 font-casual text-sm rounded-sm px-4 py-2 w-full focus-visible:border-gamefiDark-350",name:"title",placeholder:"Summarise your experience in one phrase",autoFocus:!0,maxLength:100},Q("title",{required:!0,minLength:10,maxLength:100,validate:ak}))),S.title&&(0,i.jsx)("div",{className:"mt-2 text-normal text-red-500 ",children:"validate"===String(null===(b=S.title)|| void 0===b?void 0:b.type)?A(null===(c=S.title)|| void 0===c?void 0:c.message):af[1]})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("div",{className:"text-sm mb-2 font-casual text-gamefiDark-350 text-[13px]",children:"Review *"}),(0,i.jsx)("textarea",(0,f.Z)({className:"bg-[#303035] border border-[#3C3C42] placeholder-white placeholder-opacity-30 font-casual text-sm rounded-sm px-4 py-2 w-full focus-visible:border-gamefiDark-350",name:"review",rows:12,cols:10,placeholder:"Tell your personal experience with this "+("guild"===C?"guild":"game")},Q("review",{required:!0,minLength:50,validate:ak}))),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[S.review?(0,i.jsx)("div",{className:"text-normal text-red-500 ",children:"validate"===String(null===(e=S.review)|| void 0===e?void 0:e.type)?A(null===(n=S.review)|| void 0===n?void 0:n.message):af[2]}):(0,i.jsx)("div",{}),(0,i.jsx)("div",{className:"",children:null===(p=Y("review"))|| void 0===p?void 0:p.length})]})]})]}),(0,i.jsxs)("div",{className:"mb-14",children:[(0,i.jsx)(x,{data:E,title:"pros",onChange:F,currentResource:C}),(0,i.jsx)(x,{data:H,title:"cons",onChange:I,currentResource:C})]}),(0,i.jsxs)("div",{className:"flex justify-end h-9",children:[(0,i.jsx)("button",{className:"font-mechanic bg-gamefiDark-900 text-gamefiGreen-700 hover:text-gamefiGreen-200 clipped-b-l py-2 px-7 rounded leading-5 font-bold text-sm",onClick:ap,children:"Cancel"}),(0,i.jsx)("button",{className:"w-36 bg-gamefiGreen-700 clipped-b-l p-px rounded cursor-pointer mr-3 h-9 disabled:cursor-not-allowed",onClick:an,disabled:ab,children:(0,i.jsx)("div",{className:"flex align-center justify-center h-full font-mechanic bg-gamefiDark-900 text-gamefiGreen-700 hover:text-gamefiGreen-200 clipped-b-l py-2 px-6 rounded leading-5 uppercase font-bold text-[13px]",children:"save draft"})}),(0,i.jsx)("button",{disabled:ab,className:"w-36 uppercase overflow-hidden px-8 bg-gamefiGreen-700 text-gamefiDark-900 font-bold text-[13px] rounded-xs hover:opacity-95 cursor-pointer rounded-sm clipped-t-r disabled:cursor-not-allowed",onClick:ao,children:"Submit"})]})]})]}),(0,i.jsxs)("div",{className:"hidden md:block md:col-span-3",children:[(0,i.jsx)("div",{className:"uppercase font-bold text-2xl mb-8",children:"Checkpoints"}),af.map(function(a){return(0,i.jsxs)("div",{className:"flex mb-4",children:[(0,i.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M8 0C3.6 0 0 3.6 0 8C0 12.4 3.6 16 8 16C12.4 16 16 12.4 16 8C16 3.6 12.4 0 8 0ZM7 11.4L3.6 8L5 6.6L7 8.6L11 4.6L12.4 6L7 11.4Z",fill:"#484A50"})}),(0,i.jsx)("div",{className:"ml-2 text-[13px] font-casual",children:a})]},a)})]})]})}},110:function(a,b,c){var d=c(85893),e=[1,2,3,4,5];function f(a){var b=a.highLight,c=a.extraClass;return(0,d.jsx)("svg",{className:c,viewBox:"0 0 32 31",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)("path",{stroke:"#FFB800",fill:b?"#FFB800":"",strokeMiterlimit:"10",d:"M29.2942 10.5997L21.1716 9.4212L17.5937 1.95751C16.9168 0.680829 14.8862 0.680829 14.2093 1.95751L10.6314 9.4212L2.60546 10.5997C1.05828 10.7961 0.478091 12.7602 1.54177 13.8405L7.44038 19.6347L6.0866 27.7858C5.79651 29.3571 7.44038 30.5356 8.79416 29.7499L16.0466 25.9199L23.2989 29.7499C24.6527 30.4374 26.2966 29.2589 26.0065 27.7858L24.6527 19.6347L30.5513 13.8405C31.5183 12.7602 30.8414 10.8943 29.2942 10.5997Z"})})}var g=function(a){var b=a.rate,c=a.callBack,g=a.disabled,h=a.extraClass,i=void 0===h?"w-8 h-8":h;return(0,d.jsx)("div",{className:"flex gap-3 md:py-0",children:e.map(function(a){return(0,d.jsx)("button",{onClick:c(a),disabled:g,className:"disabled:cursor-not-allowed",children:(0,d.jsx)(f,{highLight:b>=a,extraClass:i})},"ReviewRatingAction-".concat(a))})})};b.Z=g},75960:function(a,b,c){var d=c(85893),e=c(86010),f=function(a){var b=a.isPart,c=a.className;return b?(0,d.jsxs)("div",{className:(0,e.Z)(c,"loader-wrapper mx-auto h-full w-full top-0 left-0 absolute z-10"),children:[(0,d.jsxs)("svg",{className:"loader",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):(0,d.jsxs)("div",{className:(0,e.Z)(c,"fixed flex gap-2 justify-center items-center uppercase font-casual font-semibold z-10 inset-0 bg-gamefiDark-900 bg-opacity-90"),children:[(0,d.jsxs)("svg",{className:"animate-spin w-8 h-8",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"opacity-25"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]})};b.Z=f},79741:function(a,b,c){c.d(b,{P0:function(){return k}});var d=c(85893),e=c(67294),f=c(9005),g=c(11163),h=c(75787),i=c(23010),j=(0,e.createContext)({showCaptcha:function(){},resetToken:function(){},tokenCaptcha:"",setAccountHub:function(){},accountHub:{}}),k=function(){return(0,e.useContext)(j)},l=function(a){var b=a.children,c=(0,e.useState)(""),k=c[0],l=c[1],m=(0,e.useState)(null),n=m[0],o=m[1],p=(0,h.j)().account,q=(0,g.useRouter)(),r=(0,e.useRef)();(0,e.useEffect)(function(){p?new Promise(function(a,b){if(!p){b(Error("Please connect wallet"));return}var c="HUB_PROFILE_".concat(p),d=["tasks"].some(function(a){return q.asPath.includes(a)});if((null==window?void 0:window.sessionStorage)&&window.sessionStorage.getItem(c)&&!d){var e=JSON.parse(window.sessionStorage.getItem(c));if(e){a(e);return}}(0,f._i)("/api/hub/profile/".concat(p),{method:"GET"}).then(function(d){var e=d.data,f=d.error,g=d.err;if(f){console.debug("first2",f,g),(null==g?void 0:g.status)===403&&(o(null),sessionStorage.clear()),b(f);return}if(!e){b(Error("Not found user"));return}(null==window?void 0:window.sessionStorage)&&window.sessionStorage.setItem(c,JSON.stringify(e)),a(e)}).catch(function(a){b(a)})}).then(function(a){return o(a)}).catch(function(a){o(null),console.debug("err",a)}):o(null)},[p]);var s=function(a){l(a)},t=function(){var a;null==r||null===(a=r.current)|| void 0===a||a.resetCaptcha(),l("")},u=function(){},v=function(){console.debug("hCaptcha Token Expiredsdsd")},w=function(a){console.debug("hCaptcha Error: ".concat(a))},x=function(a,b){var c;null==r||null===(c=r.current)|| void 0===c||c.execute({async:!0}).then(function(b){a(b.response)}).catch(function(a){b(Error("")),console.debug("err1",a)})};return(0,d.jsxs)(j.Provider,{value:{showCaptcha:x,tokenCaptcha:k,resetToken:t,accountHub:n,setAccountHub:o},children:[b,(0,d.jsx)(i.Z,{className:"w-full",onChange:s,ref:r,onLoad:u,size:"invisible",onError:w,onExpire:v,source:"hub"})]})};b.ZP=l},3360:function(a,b,c){c.d(b,{F:function(){return f}});var d=c(26042),e=c(29815),f=function(a){var b=function(a){return"[object Object]"===Object.prototype.toString.call(a)},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=function(a){return a.attributes?(0,d.Z)({id:a.id||null},a.attributes):a};if(c(a))return a.map(function(a){return f(a)});if(b(a))for(var h in a=c(a.data)?(0,e.Z)(a.data):b(a.data)?g((0,d.Z)({},a.data)):null===a.data?null:g(a))a[h]=f(a[h]);return a}},21405:function(a,b,c){var d=c(67294),e=c(75787),f=c(37033),g=c(9005),h=c(53645),i=c(79741),j=c(99245),k=c.n(j),l=function(){var a=(0,e.j)().account,b=(0,h.tN)().setShowModal,c=(0,f.ZP)().signMessage,j=(0,i.P0)(),l=j.showCaptcha,m=j.tokenCaptcha,n=j.resetToken,o=j.accountHub,p=j.setAccountHub;return{connectWallet:(0,d.useCallback)(function(d,e){return new Promise(function(f,h){if(!a){b(!0),h(Error("Please connect wallet"));return}var i=function(b){c().then(function(c){if(c||f({error:"Could not create account"}),!k()(o)){f({walletAddress:o.walletAddress,captcha:b||m,signature:c});return}var d={walletAddress:a,captcha:b||m};e&&(d.email=e),(0,g._i)("/api/hub/registerWallet",{method:"POST",body:JSON.stringify(d),headers:{"X-Signature":c,"X-Wallet-Address":a}}).then(function(a){var b,d;n(),a.error&&f({error:a}),(null===(b=a.data)|| void 0===b?void 0:b.walletAddress)||f({error:"Could not create account"}),p(a.data),f({walletAddress:null===(d=a.data)|| void 0===d?void 0:d.walletAddress,isRegister:!0,signature:c})}).catch(function(a){n(),console.debug("err",a)})}).catch(function(a){n(),h(a)})};if(d||k()(o)){l(i,h);return}i("")})},[a,o,b,c,m,n,p,l])}};b.Z=l},22243:function(a,b,c){var d=c(79741),e=function(){return{accountHub:(0,d.P0)().accountHub}};b.Z=e},37033:function(a,b,c){c.d(b,{gd:function(){return g}});var d=c(67294),e=c(75787);c(17271);var f=c(61105),g="Gamefi Signature",h=function(){var a=(0,e.j)(),b=a.library,c=a.account;return{signMessage:(0,d.useCallback)(function(){return new Promise(function(a,d){if(!b||!c){d(Error("Please connect wallet"));return}var e="SIGNATURE_".concat(c);if(null==window?void 0:window.sessionStorage){var h=window.sessionStorage.getItem(e);if(h&&f.n5(g,h).toLowerCase()===c.toLowerCase()){a(h);return}}b.getSigner().signMessage(g).then(function(b){(null==window?void 0:window.sessionStorage)&&window.sessionStorage.setItem(e,b),a(b)}).catch(function(a){d(a||"Something went wrong when signing message")})})},[b,c])}};b.ZP=h}}])